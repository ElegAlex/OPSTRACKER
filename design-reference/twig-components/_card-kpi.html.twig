{#
    Component: KPI Card Widget
    Usage: Dashboard KPIs (Réalisé, Planifié, Reporté, À remédier)
    
    Props:
    - count: number (ex: 619)
    - label: string (ex: "Réalisé")
    - color: string (success|primary|warning|danger)
    - icon: string (feather icon name: check-circle, clock, pause-circle, alert-triangle)
    - percentage: number (ex: 73)
    - trend: string|null (ex: "+12 aujourd'hui")
    - trendType: string (positive|negative|neutral)
#}

{% set colorClasses = {
    'success': { bg: 'bg-success', bgLight: 'bg-success/10', text: 'text-success' },
    'primary': { bg: 'bg-primary', bgLight: 'bg-primary/10', text: 'text-primary' },
    'warning': { bg: 'bg-warning', bgLight: 'bg-warning/10', text: 'text-warning' },
    'danger': { bg: 'bg-danger', bgLight: 'bg-danger/10', text: 'text-danger' },
} %}

{% set colors = colorClasses[color] ?? colorClasses['primary'] %}

<div class="bg-white border-2 border-ink p-6 relative overflow-hidden">
    {# Liseré coloré en haut #}
    <div class="absolute top-0 left-0 w-full h-2 {{ colors.bg }}"></div>
    
    {# Header: Icône + Trend #}
    <div class="flex items-start justify-between mb-4">
        {# Icône dans carré coloré (RGAA: signal 1) #}
        <div class="w-12 h-12 {{ colors.bgLight }} flex items-center justify-center">
            <i data-feather="{{ icon }}" class="w-6 h-6 {{ colors.text }}"></i>
        </div>
        
        {# Trend indicator #}
        {% if trend %}
            <span class="text-xs font-semibold {{ colors.text }} uppercase tracking-wider">
                {{ trend }}
            </span>
        {% endif %}
    </div>
    
    {# Compteur principal #}
    <p class="text-5xl font-bold tabular-nums tracking-tight text-ink mb-1">
        {{ count|number_format(0, ',', ' ') }}
    </p>
    
    {# Label statut (RGAA: signal 2 - texte) #}
    <p class="text-sm font-medium text-muted uppercase tracking-wide">
        {{ label }}
    </p>
    
    {# Progress bar avec pourcentage #}
    <div class="mt-4 pt-4 border-t border-ink/10">
        <div class="h-1.5 bg-paper">
            <div class="h-full {{ colors.bg }}" style="width: {{ percentage }}%"></div>
        </div>
        <p class="text-xs text-muted mt-2">{{ percentage }}% du total</p>
    </div>
</div>
