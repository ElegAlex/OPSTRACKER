{% extends 'campagne/_layout.html.twig' %}

{% block title %}Ajouter un document - {{ campagne.nom }}{% endblock %}

{% block main %}
<div class="flex-1 overflow-y-auto p-8">
    {# Header #}
    <div class="mb-8">
        <div class="flex items-center gap-2 text-sm text-muted mb-4">
            <a href="{{ path('app_campagne_index') }}" class="hover:text-ink">Campagnes</a>
            <i data-feather="chevron-right" class="w-4 h-4"></i>
            <a href="{{ path('app_dashboard_campagne', {id: campagne.id}) }}" class="hover:text-ink">{{ campagne.nom }}</a>
            <i data-feather="chevron-right" class="w-4 h-4"></i>
            <a href="{{ path('app_document_index', {campagneId: campagne.id}) }}" class="hover:text-ink">Documents</a>
            <i data-feather="chevron-right" class="w-4 h-4"></i>
            <span class="text-ink">Ajouter</span>
        </div>

        <h1 class="text-3xl font-bold text-ink mb-2">Ajouter un document</h1>
        <p class="text-muted">{{ campagne.nom }}</p>
    </div>

    {# Flash messages #}
    {% for label, messages in app.flashes %}
        {% for message in messages %}
        <div class="mb-6 p-4 border-2 {{ label == 'success' ? 'border-success bg-success/10 text-success' : 'border-danger bg-danger/10 text-danger' }}">
            <div class="flex items-center gap-3">
                <i data-feather="{{ label == 'success' ? 'check-circle' : 'alert-circle' }}" class="w-5 h-5"></i>
                {{ message }}
            </div>
        </div>
        {% endfor %}
    {% endfor %}

    <div class="max-w-2xl">
        <div class="bg-white border-2 border-ink p-8">
            {{ form_start(form, {'attr': {'class': 'space-y-6', 'enctype': 'multipart/form-data'}}) }}

            <div>
                {{ form_label(form.file, null, {'label_attr': {'class': 'block text-sm font-medium text-ink uppercase tracking-wider mb-2'}}) }}
                <div class="border-2 border-dashed border-ink/30 p-8 text-center hover:border-primary transition-colors">
                    <i data-feather="upload-cloud" class="w-12 h-12 text-muted mx-auto mb-4"></i>
                    <p class="text-muted mb-2">Cliquez ou glissez-deposez un fichier</p>
                    <p class="text-sm text-muted">PDF, DOCX, DOC, PS1, BAT, ZIP, EXE - Max 50 Mo</p>
                    <div class="mt-4">
                        {{ form_widget(form.file) }}
                    </div>
                </div>
                {{ form_errors(form.file) }}
            </div>

            <div>
                {{ form_label(form.type, null, {'label_attr': {'class': 'block text-sm font-medium text-ink uppercase tracking-wider mb-2'}}) }}
                {{ form_widget(form.type) }}
                {{ form_errors(form.type) }}
            </div>

            <div>
                {{ form_label(form.description, null, {'label_attr': {'class': 'block text-sm font-medium text-ink uppercase tracking-wider mb-2'}}) }}
                {{ form_widget(form.description) }}
                {{ form_errors(form.description) }}
            </div>

            <div class="flex items-center gap-4 pt-6 border-t border-ink/10">
                <button type="submit" class="px-6 py-3 bg-primary text-white font-medium hover:bg-primary/80 transition-colors flex items-center gap-2">
                    <i data-feather="upload" class="w-5 h-5"></i>
                    Uploader
                </button>
                <a href="{{ path('app_document_index', {campagneId: campagne.id}) }}" class="px-6 py-3 border-2 border-ink text-ink font-medium hover:bg-ink hover:text-white transition-colors">
                    Annuler
                </a>
            </div>

            {{ form_end(form) }}
        </div>

        {# Avertissement fichiers executables #}
        <div class="mt-6 p-4 bg-warning/10 border-2 border-warning">
            <div class="flex items-start gap-3">
                <i data-feather="alert-triangle" class="w-5 h-5 text-warning flex-shrink-0 mt-0.5"></i>
                <div>
                    <h3 class="font-bold text-warning">Fichiers executables</h3>
                    <p class="text-sm text-warning/80 mt-1">
                        Les fichiers PS1, BAT et EXE sont autorises pour usage interne uniquement (scripts de deploiement).
                        Assurez-vous de leur provenance avant de les uploader.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
