{% extends 'campagne/_layout.html.twig' %}

{% block title %}Transferer la propriete - {{ campagne.nom }} - OpsTracker{% endblock %}

{% block main %}
{# HEADER #}
<header class="bg-white px-12 py-10 border-b-4 border-ink">
    <div class="flex justify-between items-start">
        <div>
            <div class="flex items-center gap-3 mb-2">
                <div class="w-3 h-3 bg-{{ campagne.statutCouleur }}"></div>
                <span class="text-xs font-semibold text-muted uppercase tracking-[0.15em]">Campagne</span>
            </div>
            <h1 class="text-4xl font-bold tracking-tight">Transferer la propriete</h1>
            <p class="text-sm text-muted mt-2">{{ campagne.nom }}</p>
        </div>
        <a href="{{ path('app_campagne_show', {id: campagne.id}) }}" class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-muted hover:text-ink transition-colors">
            <i data-feather="arrow-left" class="w-4 h-4"></i>
            Retour
        </a>
    </div>
</header>

{# CONTENT #}
<div class="flex-1 overflow-auto">
    <div class="px-12 py-10">

        {# Flash messages #}
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="mb-6 p-4 border-2 border-ink/20 bg-{{ label == 'success' ? 'success' : 'danger' }}/10 flex items-center gap-3">
                    <i data-feather="{{ label == 'success' ? 'check-circle' : 'alert-circle' }}" class="w-5 h-5 text-{{ label == 'success' ? 'success' : 'danger' }}"></i>
                    <span class="text-sm font-medium">{{ message }}</span>
                </div>
            {% endfor %}
        {% endfor %}

        <div class="max-w-xl">
            {# Info proprietaire actuel #}
            <div class="bg-white border-2 border-ink p-6 mb-8">
                <h3 class="text-sm font-bold text-muted uppercase tracking-wider mb-4">Proprietaire actuel</h3>
                {% if campagne.proprietaire %}
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-primary/10 flex items-center justify-center">
                        <i data-feather="user" class="w-6 h-6 text-primary"></i>
                    </div>
                    <div>
                        <p class="font-bold text-ink">{{ campagne.proprietaire.prenom }} {{ campagne.proprietaire.nom }}</p>
                        <p class="text-sm text-muted">{{ campagne.proprietaire.email }}</p>
                    </div>
                </div>
                {% else %}
                <p class="text-sm text-muted">Aucun proprietaire defini</p>
                {% endif %}
            </div>

            {# Avertissement #}
            <div class="bg-warning/10 border-2 border-warning p-4 mb-8">
                <div class="flex items-start gap-3">
                    <i data-feather="alert-triangle" class="w-5 h-5 text-warning flex-shrink-0 mt-0.5"></i>
                    <div>
                        <p class="text-sm font-bold text-warning">Attention</p>
                        <p class="text-sm text-muted mt-1">Le transfert de propriete est irreversible. Le nouveau proprietaire aura tous les droits sur cette campagne.</p>
                    </div>
                </div>
            </div>

            {# Formulaire #}
            <div class="bg-white border-2 border-ink p-6">
                <h3 class="text-sm font-bold text-muted uppercase tracking-wider mb-6">Nouveau proprietaire</h3>

                {{ form_start(form, {attr: {class: 'space-y-6'}}) }}

                <div>
                    {{ form_label(form.nouveauProprietaire, null, {label_attr: {class: 'block text-sm font-medium text-ink mb-2'}}) }}
                    {{ form_widget(form.nouveauProprietaire) }}
                    {{ form_errors(form.nouveauProprietaire) }}
                </div>

                <div class="flex items-center gap-4 pt-4">
                    <button type="submit" class="flex items-center gap-2 px-6 py-3 text-sm font-semibold text-white bg-ink hover:bg-ink/90 transition-colors">
                        <i data-feather="user-check" class="w-4 h-4"></i>
                        Transferer la propriete
                    </button>
                    <a href="{{ path('app_campagne_show', {id: campagne.id}) }}" class="px-6 py-3 text-sm font-medium text-muted hover:text-ink transition-colors">
                        Annuler
                    </a>
                </div>

                {{ form_end(form) }}
            </div>
        </div>
    </div>
</div>
{% endblock %}
